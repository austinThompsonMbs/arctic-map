{"version":3,"file":"ArcticMap.js","sources":["../../node_modules/style-inject/dist/style-inject.es.js","../../src/lib/ArcticMap.js","../../src/lib/ArcticMapEdit.js","../../src/lib/ArcticMapLayer.js","../../src/lib/ArcticMapLLDSearch.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React from 'react';\r\nimport async from 'async';\r\nimport './ArcticMap.css';\r\n\r\nimport { Map, loadModules } from 'react-arcgis'\r\n\r\n\r\nclass ArcticMap extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      map: null,\r\n      view: null,\r\n      hideBasemapButton: false,\r\n      loading: false,\r\n      lat: props.lat,\r\n      lng: props.lng,\r\n    }\r\n\r\n    this.handleMapLoad = this.handleMapLoad.bind(this)\r\n    this.handleMapClick = this.handleMapClick.bind(this)\r\n    this.layers = []\r\n  }\r\n\r\n  componentWillMount() {\r\n\r\n  }\r\n\r\n  render() {\r\n    var self = this\r\n    var index = 0\r\n    this.layers = []\r\n    var children = React.Children.map(this.props.children, function (child) {\r\n      if (child.type.name === 'ArcticMapLayer') {\r\n        return React.cloneElement(child, {\r\n          ref: (c) => { if (c) { self.layers.push(c) } }\r\n        })\r\n      } else if (child.type.name === 'ArcticMapEdit') {\r\n        // console.log(self.refs);\r\n        return React.cloneElement(child, {\r\n          // ref: 'editor'\r\n        })\r\n\r\n      } else if (child.type.name === 'ArcticMapLLDSearch') {\r\n\r\n        return React.cloneElement(child, {\r\n        })\r\n\r\n      } else {\r\n        return React.cloneElement(child, {\r\n          ref: 'child-' + (index++)\r\n        })\r\n      }\r\n    })\r\n\r\n    if (children) {\r\n      children = children.sort(l => l.type.name === 'ArcticMapEdit').reverse()\r\n    } else {\r\n      children = (<div />)\r\n    }\r\n\r\n    // console.log(this.props.children);\r\n    // this.props.children.forEach((child) =>{\r\n    //         child.ref = (c) => {this.layers.push(c) };\r\n    // });\r\n\r\n    return <Map class='full-screen-map'\r\n      mapProperties={{ basemap: 'hybrid' }} onLoad={this.handleMapLoad} onClick={this.handleMapClick} >\r\n      {children}\r\n      <div id='bottombar'>\r\n        {this.state.hideBasemapButton === false &&\r\n          <button className='action-button esri-icon-layers' id='pointButton'\r\n            type='button' title='Map Layers' onClick={this.handleShowBasemaps.bind(this)} />\r\n        }\r\n      </div>\r\n\r\n      <div id='bottomleftbar'>\r\n        {this.state.loading === true &&\r\n          <p>Loading...</p>\r\n        }\r\n      </div>\r\n    </Map>\r\n  }\r\n\r\n  handleShowBasemaps(event) {\r\n    this.state.view.ui.add(this.basemapGallery, {\r\n      position: 'bottom-right'\r\n    })\r\n    this.setState({ hideBasemapButton: true })\r\n  }\r\n\r\n  handleMapClick(event) {\r\n    // console.log(event);\r\n  }\r\n\r\n  createElementFromHTML(htmlString) {\r\n    var div = document.createElement('div');\r\n    div.innerHTML = htmlString.trim();\r\n\r\n    // Change this to div.childNodes to support multiple top-level nodes\r\n    return div.firstChild;\r\n  }\r\n\r\n\r\n  setJson(json) {\r\n    if (this.state.map.editor) {\r\n      this.state.map.editor.setEditFeature(json, true);\r\n    }\r\n  }\r\n\r\n\r\n  handleMapLoad(map, view) {\r\n    // var featureLayer = new FeatureLayer({\r\n    //     url: \"https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/Landscape_Trees/FeatureServer/0\"\r\n    // });\r\n\r\n    // map.add(featureLayer);\r\n\r\n    this.setState({ map, view })\r\n\r\n    var self = this\r\n\r\n    loadModules([\r\n      'esri/widgets/LayerList',\r\n      'esri/widgets/Locate',\r\n      'esri/widgets/BasemapGallery',\r\n      'esri/widgets/Home',\r\n      'esri/widgets/Zoom',\r\n      'esri/widgets/Search',\r\n      'esri/tasks/Locator',\r\n      'esri/geometry/geometryEngine'\r\n    ]).then(([\r\n      LayerList,\r\n      Locate,\r\n      BasemapGallery,\r\n      Home,\r\n      Zoom,\r\n      Search,\r\n      Locator,\r\n      geometryEngine\r\n    ]) => {\r\n\r\n\r\n\r\n\r\n      var layerList = new LayerList({\r\n        view: self.state.view,\r\n        listItemCreatedFunction: function (event) {\r\n          const item = event.item\r\n          item.panel = {\r\n            content: 'legend',\r\n            open: false\r\n          }\r\n        }\r\n      })\r\n\r\n      view.popup.dockEnabled = true\r\n      view.popup.dockOptions.position = 'bottom-left'\r\n      //var layers = React.Children.toArray(this.props.children).filter((ele) => ele.type.name === \"ArcticMapLayer\");\r\n\r\n\r\n\r\n      // console.log(layers);\r\n      view.popup.watch('selectedFeature', function (graphic) {\r\n        if (graphic) {\r\n          var graphicTemplate = graphic.getEffectivePopupTemplate()\r\n          graphicTemplate.actions = [{\r\n            id: 'select-item',\r\n            // image: \"beer.png\",\r\n            title: 'Select'\r\n          }]\r\n\r\n          graphicTemplate.actions.items[0].visible = self.state.map.editor !== undefined// graphic.attributes.website ? true : false;\r\n          //self.state.view.goTo(graphic);\r\n        }\r\n      })\r\n      view.popup.viewModel.on('trigger-action', function (event) {\r\n        if (event.action.id === 'select-item') {\r\n          // do something\r\n          // console.log(event.target.selectedFeature);\r\n          self.state.map.editor.setEditFeature(event.target.selectedFeature)\r\n        }\r\n      })\r\n\r\n      var popup = view.popup\r\n\r\n      view.on('click', (event) => {\r\n        setTimeout(() => {\r\n\r\n          if (self.state.map.editor && self.state.map.editor.state.editing === true) {\r\n            return\r\n          }\r\n          // console.log(event);\r\n          // need to work on identify and add to a single popup\r\n          // https://developers.arcgis.com/javascript/latest/sample-code/sandbox/index.html?sample=tasks-identify\r\n\r\n          var identresults = []\r\n          document.getElementsByClassName('esri-view-root')[0].style.cursor = 'wait';\r\n          this.setState({ loading: true })\r\n          \r\n\r\n          async.eachSeries(self.layers, (layer, cb) => {\r\n            layer.identify(event, (results) => {\r\n              if(results){\r\n              results.layer = layer\r\n              identresults.push(results)\r\n              }\r\n              cb()\r\n            })\r\n          }, (err) => {\r\n            var results = identresults.map(ir => {\r\n              ir.results.forEach(res => {\r\n                res.layer = ir.layer\r\n                res.acres = geometryEngine.geodesicArea(res.feature.geometry, 'acres')\r\n              })\r\n              return ir.results\r\n            }) || [].reduce(function (a, b) { return a.concat(b) })\r\n\r\n            console.log(results)\r\n            results.sort((r1, r2) => {\r\n              return r1.acres > r2.acres\r\n              //r.feature.attributes.Shape_Area\r\n            })\r\n\r\n\r\n\r\n            //results = results.reverse();\r\n            var popupresults = results.map(function (result) {\r\n              var feature = result.feature\r\n              var layerName = result.layerName\r\n\r\n              feature.attributes.layerName = layerName\r\n\r\n\r\n              var displayValue = result.feature.attributes[result.displayFieldName]\r\n\r\n\r\n              feature.popupTemplate = { // autocasts as new PopupTemplate()\r\n                title: layerName,\r\n                content: result.layer.renderPopup(feature),\r\n                actions: [{ title: \"Select\", id: \"select-action\" }]\r\n              }\r\n\r\n\r\n\r\n              return feature\r\n            })\r\n\r\n            if (popupresults.length > 0) {\r\n              view.popup.close();\r\n              self.state.view.popup.open({\r\n                features: popupresults,\r\n                location: event.mapPoint\r\n              })\r\n\r\n              self.state.view.popup.on('trigger-action', (e) => {\r\n                if (e.action.id === 'select-action') {\r\n                  console.log(\"Fire Select\");\r\n                }\r\n              });\r\n\r\n\r\n            }\r\n            this.setState({ loading: false })\r\n            document.getElementsByClassName('esri-view-root')[0].style.cursor = 'auto';\r\n          })\r\n\r\n          // self.layers.forEach(layer => {\r\n          //     layer.identify(event);\r\n          // })\r\n\r\n        }, 100);\r\n\r\n      })\r\n\r\n      // Add widget to the top right corner of the view\r\n      self.state.view.ui.add(layerList, 'top-left')\r\n\r\n\r\n      var locateBtn = new Locate({\r\n        view: self.state.view\r\n      })\r\n\r\n      self.state.view.ui.add(locateBtn, {\r\n        position: 'top-right'\r\n      })\r\n\r\n      this.basemapGallery = new BasemapGallery({\r\n        view: self.state.view\r\n      })\r\n      this.basemapGallery.on('selection-change', function () {\r\n        console.log('Basemap Changed')\r\n      })\r\n\r\n\r\n      // Add the widget to the top-right corner of the view\r\n\r\n\r\n      var homeBtn = new Home({\r\n        view: view\r\n      })\r\n\r\n      // Add the home button to the top left corner of the view\r\n      view.ui.add(homeBtn, 'top-right')\r\n\r\n      view.ui.remove('zoom')\r\n\r\n      var zoom = new Zoom({\r\n        view: self.state.view\r\n      })\r\n\r\n      view.ui.add(zoom, 'top-right')\r\n\r\n\r\n      if (self.props.search) {\r\n\r\n        var searchWidget = new Search({\r\n          view: view,\r\n\r\n        });\r\n\r\n        searchWidget.on(\"search-complete\", function (event) {\r\n          console.log(event);\r\n        });\r\n\r\n        view.ui.add(searchWidget, {\r\n          position: \"top-right\",\r\n          index: 0\r\n        });\r\n\r\n      }\r\n\r\n      //       var elestring = this.createElementFromHTML( `<input type=\"text\" placeholder=\"Find address or place\" aria-label=\"Search\" autocomplete=\"off\" tabindex=\"0\" class=\"esri-input esri-search__input\" aria-autocomplete=\"list\" aria-haspopup=\"true\" aria-owns=\"1687b00a338-widget-1-suggest-menu\" role=\"textbox\" data-node-ref=\"_inputNode\" title=\"Find address or place\">`);\r\n\r\n      //  view.ui.add(elestring, {\r\n      //         position: \"top-right\",\r\n      //         index: 0\r\n      //       });\r\n\r\n\r\n      setTimeout(() => {\r\n        var evt = new Event('mapready', { bubbles: true });\r\n        Object.defineProperty(evt, 'target', { value: self, enumerable: true });\r\n\r\n        if (self.props.onmapready) {\r\n          self.props.onmapready(evt);\r\n        }\r\n      }, 500)\r\n\r\n\r\n\r\n    })\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\nexport default ArcticMap\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { arcgisToGeoJSON } from '@esri/arcgis-to-geojson-utils';\r\n//import { geojsonToArcGIS } from '@esri/arcgis-to-geojson-utils';\r\nimport './ArcticMapEdit.css'\r\n\r\n\r\nimport {\r\n    loadModules\r\n} from 'react-arcgis';\r\n\r\n\r\nclass ArcticMapEdit extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        console.log(\"Loading MapEdit\");\r\n        props.map.editor = this;\r\n        this.state = {\r\n            map: props.map,\r\n            view: props.view,\r\n            graphic: null,\r\n            hideEditors: false,\r\n            editing: false,\r\n        };\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.view.graphics.remove(this.state.graphic);\r\n    }\r\n\r\n    componentWillMount() {\r\n\r\n\r\n\r\n        var self = this;\r\n        loadModules([\"esri/Graphic\",\r\n            \"esri/layers/GraphicsLayer\",\r\n            \"esri/widgets/Sketch/SketchViewModel\",\r\n            \"esri/geometry/Geometry\"\r\n        ]).then(([\r\n            Graphic,\r\n            GraphicsLayer,\r\n            SketchViewModel,\r\n            Geometry\r\n        ]) => {\r\n            const tempGraphicsLayer = new GraphicsLayer({ title: 'Edit Layer', listMode: \"hide\" });\r\n            self.setState({ tempGraphicsLayer });\r\n\r\n            self.state.map.add(tempGraphicsLayer);\r\n\r\n\r\n            const sketchViewModel = new SketchViewModel({\r\n                view: self.state.view,\r\n                layer: tempGraphicsLayer,\r\n                pointSymbol: {\r\n                    type: \"simple-marker\", // autocasts as new SimpleMarkerSymbol()\r\n                    style: \"circle\",\r\n                    color: \"yellow\",\r\n                    size: \"3px\",\r\n                    outline: { // autocasts as new SimpleLineSymbol()\r\n                        color: [255, 255, 255],\r\n                        width: 3\r\n                    }\r\n                },\r\n                polylineSymbol: {\r\n                    type: \"simple-line\", // autocasts as new SimpleLineSymbol()\r\n                    color: \"yellow\",\r\n                    width: \"3\",\r\n                    style: \"solid\"\r\n                },\r\n                polygonSymbol: {\r\n                    type: \"simple-fill\", // autocasts as new SimpleFillSymbol()\r\n                    color: \"rgba(224, 206, 69, 0.8)\",\r\n                    style: \"solid\",\r\n                    outline: {\r\n                        color: \"yellow\",\r\n                        width: 3\r\n                    }\r\n                }\r\n            });\r\n\r\n\r\n            self.setState({ tempGraphicsLayer, sketchViewModel });\r\n\r\n            self.setUpClickHandler.bind(this);\r\n\r\n            sketchViewModel.on(\"create\", (event) => {\r\n\r\n                if (event.state === 'complete') {\r\n                    const graphic = new Graphic({\r\n                        geometry: event.graphic.geometry,\r\n                        symbol: event.graphic.symbol\r\n                    });\r\n                    tempGraphicsLayer.add(event.graphic);\r\n                    if (this.props.single) {\r\n                        console.log(\"Added one feature\");\r\n                        this.setState({ hideEditors: true });\r\n                    }\r\n\r\n                    self.setState({ geojson: arcgisToGeoJSON(event.graphic.geometry.toJSON()), datajson: event.graphic.toJSON(), editing: false });\r\n                    //this.geojson = event.geometry;\r\n\r\n                    self.firenewfeature();\r\n                }\r\n            });\r\n\r\n\r\n            sketchViewModel.on(\"update\", (event) => {\r\n                self.setState({ editing: true });\r\n                if (event.state === 'complete' || event.state === 'cancel') {\r\n                    // const graphic = new Graphic({\r\n                    //     geometry: event.graphic.geometry,\r\n                    //     symbol: event.graphic.symbol\r\n                    // });\r\n                    //tempGraphicsLayer.add(event.graphic);\r\n                    // if (this.props.single) {\r\n                    //     console.log(\"Added one feature\");\r\n                    //     this.setState({ hideEditors: true });\r\n                    // }\r\n\r\n                    self.setState({ geojson: arcgisToGeoJSON(event.graphics[0].geometry.toJSON()), datajson: event.graphics[0].toJSON(), });\r\n                    //this.geojson = event.geometry;\r\n\r\n                    self.firenewfeature();\r\n                }\r\n            });\r\n\r\n            // Listen the sketchViewModel's update-complete and update-cancel events\r\n            sketchViewModel.on(\"update-complete\", (event) => {\r\n                event.graphic.geometry = event.geometry;\r\n                tempGraphicsLayer.add(event.graphic);\r\n\r\n                // set the editGraphic to null update is complete or cancelled.\r\n                self.state.editGraphic = null;\r\n\r\n\r\n            });\r\n            // sketchViewModel.on(\"update-cancel\", (event) => {\r\n            //     event.graphic.geometry = event.geometry;\r\n            //     tempGraphicsLayer.add(event.graphic);\r\n\r\n            //     // set the editGraphic to null update is complete or cancelled.\r\n            //     self.state.editGraphic = null;\r\n            // });\r\n\r\n\r\n            this.top_right_node = document.createElement(\"div\");\r\n            self.state.view.ui.add(this.top_right_node, \"top-right\");\r\n\r\n            self.setState({ loaded: true })\r\n\r\n\r\n            // scoped methods\r\n            self.setEditFeature = (feature, nofire) => {\r\n                if (nofire === null) {\r\n                    nofire = false;\r\n                }\r\n\r\n\r\n                this.state.sketchViewModel.reset();\r\n                this.state.tempGraphicsLayer.removeAll();\r\n                this.setState({ hideEditors: false, geojson: null });\r\n         \r\n\r\n                var graphic = null;\r\n                if (!feature.geometry.toJSON && feature.symbol) {\r\n                    graphic = Graphic.fromJSON(feature);\r\n          \r\n                }\r\n                else {\r\n\r\n\r\n\r\n                    graphic = new Graphic({\r\n                        geometry: feature.geometry,\r\n                        symbol: this.state.sketchViewModel.polygonSymbol\r\n                    });\r\n                }\r\n\r\n                //console.log(feature);\r\n                this.state.tempGraphicsLayer.add(graphic);\r\n                if (this.props.single) {\r\n                    console.log(\"Added one feature\");\r\n                    this.setState({ hideEditors: true });\r\n                }\r\n\r\n                self.state.view.goTo(graphic);\r\n\r\n\r\n                var geometry = feature.geometry;\r\n                if(!geometry.toJSON){\r\n                    geometry = Geometry.fromJSON(geometry);\r\n                }\r\n\r\n                this.setState({ geojson: arcgisToGeoJSON(geometry.toJSON()), datajson: graphic.toJSON(), });\r\n\r\n                if (nofire === true) {\r\n\r\n                }\r\n                else {\r\n                    self.firenewfeature();\r\n                }\r\n\r\n            };\r\n\r\n\r\n            self.setEditFeature = self.setEditFeature.bind(self);\r\n\r\n\r\n\r\n            self.setGeoJson = (geojson) => {\r\n                //var esrijson = geojsonToArcGIS(geojson);\r\n\r\n\r\n            }\r\n            self.setGeoJson = self.setGeoJson.bind(self);\r\n\r\n\r\n        }); //.catch ((err) => console.error(err));\r\n\r\n\r\n    }\r\n\r\n\r\n    firenewfeature() {\r\n        var self = this;\r\n        var evt = new Event('newfeature', { bubbles: true });\r\n        Object.defineProperty(evt, 'target', { value: this, enumerable: true });\r\n        evt.data = self.state.datajson;\r\n\r\n        if (self.props.onnewfeature) {\r\n            self.props.onnewfeature(evt);\r\n        }\r\n\r\n        setTimeout(() => {\r\n            self.setState({ editing: false });\r\n        }, 200);\r\n    }\r\n\r\n    addPointClick() {\r\n        this.state.sketchViewModel.create(\"point\", { mode: \"click\" });\r\n        this.setState({ editing: true });\r\n    }\r\n\r\n    addLineClick() {\r\n        this.state.sketchViewModel.create(\"polyline\", { mode: \"click\" });\r\n        this.setState({ editing: true });\r\n    }\r\n    addPolyClick() {\r\n        this.state.sketchViewModel.create(\"polygon\", { mode: \"click\" });\r\n        this.setState({ editing: true });\r\n    }\r\n    addRecClick() {\r\n        this.state.sketchViewModel.create(\"rectangle\", { mode: \"click\" });\r\n        this.setState({ editing: true });\r\n    }\r\n    addCircleClick() {\r\n        this.state.sketchViewModel.create(\"circle\", { mode: \"click\" });\r\n        this.setState({ editing: true });\r\n    }\r\n\r\n\r\n\r\n    reset() {\r\n        this.state.sketchViewModel.reset();\r\n        this.state.tempGraphicsLayer.removeAll();\r\n        this.setState({ hideEditors: false, geojson: null });\r\n\r\n    }\r\n\r\n    widgetRender() {\r\n        return <div id=\"topbar\">\r\n            {this.state.hideEditors === false &&\r\n                <span>\r\n                    {this.props.point &&\r\n                        <button className=\"action-button esri-icon-blank-map-pin\" style={{ padding: '6px' }} id=\"pointButton\" onClick={this.addPointClick.bind(this)}\r\n                            type=\"button\" title=\"Draw point\"></button>\r\n                    }\r\n                    {this.props.line &&\r\n                        <button className=\"action-button esri-icon-polyline\" style={{ padding: '6px' }} id=\"polylineButton\" type=\"button\" onClick={this.addLineClick.bind(this)}\r\n                            title=\"Draw polyline\"></button>\r\n                    }\r\n                    {this.props.polygon &&\r\n                        <button className=\"action-button esri-icon-polygon\" style={{ padding: '6px' }} id=\"polygonButton\" type=\"button\" onClick={this.addPolyClick.bind(this)}\r\n                            title=\"Draw polygon\"></button>\r\n                    }\r\n                    {this.props.square &&\r\n                        <button className=\"action-button esri-icon-checkbox-unchecked\" style={{ padding: '6px' }} id=\"rectangleButton\" onClick={this.addRecClick.bind(this)}\r\n                            type=\"button\" title=\"Draw rectangle\"></button>\r\n                    }\r\n                    {this.props.circle &&\r\n                        <button className=\"action-button esri-icon-radio-unchecked\" style={{ padding: '6px' }} id=\"circleButton\" onClick={this.addCircleClick.bind(this)}\r\n                            type=\"button\" title=\"Draw circle\"></button>\r\n                    }\r\n                </span>\r\n            }\r\n            <button className=\"action-button esri-icon-trash\" style={{ padding: '6px' }} id=\"resetBtn\" type=\"button\" onClick={this.reset.bind(this)}\r\n                title=\"Clear graphics\"></button>\r\n        </div>;\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if (this.top_right_node) {\r\n            ReactDOM.render(\r\n                this.widgetRender(),\r\n                this.top_right_node\r\n            );\r\n        }\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        //return (<h2>Test</h2>);\r\n\r\n\r\n        return (<span></span>);\r\n    }\r\n\r\n    addGraphic(event) {\r\n        // Create a new graphic and set its geometry to\r\n        // `create-complete` event geometry.\r\n        // const graphic = new Graphic({\r\n        //     geometry: event.geometry,\r\n        //     symbol: sketchViewModel.graphic.symbol\r\n        // });\r\n        // tempGraphicsLayer.add(graphic);\r\n    }\r\n\r\n    updateGraphic(event) {\r\n        // event.graphic is the graphic that user clicked on and its geometry\r\n        // has not been changed. Update its geometry and add it to the layer\r\n        // event.graphic.geometry = event.geometry;\r\n        // tempGraphicsLayer.add(event.graphic);\r\n\r\n        // // set the editGraphic to null update is complete or cancelled.\r\n        // editGraphic = null;\r\n    }\r\n\r\n    setUpClickHandler() {\r\n        var self = this;\r\n        self.state.view.on(\"click\", function (event) {\r\n            self.state.view.hitTest(event).then(function (response) {\r\n                var results = response.results;\r\n                // Found a valid graphic\r\n                if (results.length && results[results.length - 1].graphic) {\r\n                    // Check if we're already editing a graphic\r\n                    if (!self.state.editGraphic) {\r\n                        // Save a reference to the graphic we intend to update\r\n                        self.state.editGraphic = results[results.length - 1].graphic;\r\n                        // Remove the graphic from the GraphicsLayer\r\n                        // Sketch will handle displaying the graphic while being updated\r\n                        self.state.tempGraphicsLayer.remove(self.state.editGraphic);\r\n                        self.state.sketchViewModel.update(self.state.editGraphic);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    setActiveButton(selectedButton) {\r\n        // focus the view to activate keyboard shortcuts for sketching\r\n        // view.focus();\r\n        // var elements = document.getElementsByClassName(\"active\");\r\n        // for (var i = 0; i < elements.length; i++) {\r\n        //     elements[i].classList.remove(\"active\");\r\n        // }\r\n        // if (selectedButton) {\r\n        //     selectedButton.classList.add(\"active\");\r\n        // }\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default ArcticMapEdit;","import React from \"react\";\r\nimport { geojsonToArcGIS } from '@esri/arcgis-to-geojson-utils';\r\n\r\nimport {\r\n    loadModules\r\n} from 'react-arcgis';\r\n\r\nclass ArcticMapLayer extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            map: props.map,\r\n            view: props.view,\r\n            graphic: null\r\n        };\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.view.graphics.remove(this.state.graphic);\r\n    }\r\n\r\n    componentWillMount() {\r\n        var self = this;\r\n        loadModules(['esri/Graphic',\r\n            \"esri/layers/FeatureLayer\",\r\n            \"esri/layers/MapImageLayer\",\r\n            \"esri/layers/ImageryLayer\",\r\n            \"esri/layers/GeoJSONLayer\",\r\n            \"esri/layers/GraphicsLayer\",\r\n            \"esri/tasks/IdentifyTask\",\r\n            \"esri/tasks/support/IdentifyParameters\",\r\n            \"esri/geometry/Point\",\r\n            \"esri/symbols/SimpleMarkerSymbol\",\r\n            \"esri/geometry/Extent\"\r\n        ]).then(([\r\n            Graphic,\r\n            FeatureLayer,\r\n            MapImageLayer,\r\n            ImageryLayer,\r\n            GeoJSONLayer,\r\n            GraphicsLayer,\r\n            IdentifyTask,\r\n            IdentifyParameters,\r\n            Point,\r\n            SimpleMarkerSymbol,\r\n            Extent\r\n        ]) => {\r\n            // Create a polygon geometry\r\n\r\n\r\n\r\n            // this.setState({ graphic });\r\n\r\n            if (self.props.type === \"feature\") {\r\n\r\n                var featureLayer = new FeatureLayer({\r\n                    url: self.props.src,\r\n                    outFields: [\"*\"],\r\n                });\r\n                self.layerRef = featureLayer;\r\n                self.state.map.add(featureLayer);\r\n            }\r\n\r\n            if (self.props.type === \"dynamic\") {\r\n\r\n                var maplayer = new MapImageLayer({\r\n                    url: self.props.src\r\n                });\r\n                maplayer.when(() => {\r\n                    // console.log(maplayer);\r\n\r\n                    var layerids = [];\r\n                    maplayer.allSublayers.items.forEach(sublayer => {\r\n                        layerids.push(sublayer.id);\r\n                    });\r\n                    layerids.reverse();\r\n\r\n                    self.identifyTask = new IdentifyTask(self.props.src);\r\n                    self.params = new IdentifyParameters();\r\n                    self.params.tolerance = 3;\r\n                    self.params.layerIds = layerids;\r\n                    self.params.layerOption = \"visible\";\r\n                    self.params.width = self.state.view.width;\r\n                    self.params.height = self.state.view.height;\r\n                    self.params.returnGeometry = true;\r\n\r\n                    //  console.log(self.params);\r\n\r\n                });\r\n\r\n                self.layerRef = maplayer;\r\n                self.state.map.add(maplayer);\r\n            }\r\n\r\n\r\n            if (self.props.type === \"image\") {\r\n\r\n\r\n                var imagelayer = new ImageryLayer({\r\n                    url: self.props.src,\r\n                    format: \"jpgpng\" // server exports in either jpg or png format\r\n                });\r\n                self.layerRef = imagelayer;\r\n                self.state.map.add(imagelayer);\r\n\r\n            }\r\n\r\n            if (self.props.type === \"geojson\") {\r\n\r\n                var geojsonLayer = new GraphicsLayer({ title: 'GeoJSON Layer', listMode: \"hide\" });\r\n                // var geojsonLayer = new GeoJSONLayer({\r\n                //     //source: self.props.src,\r\n                //     //copyright: \"USGS Earthquakes\",\r\n                //     //popupTemplate: template\r\n                //   });\r\n                var dataarr = [];\r\n\r\n                if (typeof self.props.src == 'object') {\r\n                    if (self.props.src.features) {\r\n                        dataarr = self.props.src.features;\r\n                    }\r\n                    else {\r\n                        dataarr = self.props.src;\r\n                    }\r\n                }\r\n\r\n\r\n                dataarr.forEach(obj => {\r\n                    var esrijson = geojsonToArcGIS(obj);\r\n                    if (obj.geometry.type == \"Point\") {\r\n\r\n                        var popupTemplate = {\r\n                            title: \"{Name}\",\r\n                            content: self.props.template,\r\n                          };\r\n\r\n\r\n                        var point = new Point({\r\n                            longitude: obj.geometry.coordinates[1],\r\n                            latitude: obj.geometry.coordinates[0],\r\n                            \r\n                          });\r\n                        \r\n                          // Create a symbol for drawing the point\r\n                          var markerSymbol = new SimpleMarkerSymbol({\r\n                            color: [226, 119, 40],\r\n                            outline: {\r\n                              color: [255, 255, 255],\r\n                              width: 1\r\n                            }\r\n                          });\r\n                        \r\n                          // Create a graphic and add the geometry and symbol to it\r\n                          var pointGraphic = new Graphic({\r\n                            geometry: point,\r\n                            symbol: markerSymbol,\r\n                            attributes : obj.properties,\r\n                            popupTemplate: popupTemplate,\r\n                           // extent : new Extent().centerAt(point)\r\n                          });\r\n                        \r\n                          // Add the graphic to the view\r\n                          geojsonLayer.graphics.add(pointGraphic);\r\n                    }\r\n\r\n\r\n                })\r\n\r\n\r\n                self.layerRef = geojsonLayer;\r\n                self.state.map.add(geojsonLayer);\r\n                // var imagelayer = new ImageryLayer({\r\n                //     url: self.props.src,\r\n                //     format: \"jpgpng\" // server exports in either jpg or png format\r\n                // });\r\n                // self.layerRef = imagelayer;\r\n                // self.state.map.add(imagelayer);\r\n\r\n            }\r\n\r\n\r\n            self.layerRef.when(function(){\r\n            setTimeout(() => {\r\n                var evt = new Event('ready', { bubbles: true });\r\n                Object.defineProperty(evt, 'target', { value: self, enumerable: true });\r\n        \r\n                if (self.props.onready) {\r\n                  self.props.onready(evt);\r\n                }\r\n              }, 500)\r\n            });\r\n\r\n            //this.state.view.graphics.add(graphic);\r\n        }); //.catch ((err) => console.error(err));\r\n    }\r\n\r\n    zoomto(){\r\n        if(this.layerRef.graphics){\r\n        this.state.view.goTo(this.layerRef.graphics.items);\r\n        }\r\n       \r\n    }\r\n\r\n    renderPopup(feature) {\r\n        if (!true) {\r\n\r\n        }\r\n        else {\r\n            console.log(feature);\r\n            var popupText = \"\";\r\n            var atts = Object.getOwnPropertyNames(feature.attributes);\r\n            atts.forEach(att => {\r\n                popupText += `<b>${att}</b> : ${feature.attributes[att]}<br/>`\r\n            });\r\n\r\n            return popupText;\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n\r\n    identify(event, callback) {\r\n        console.log(this.layerRef);\r\n        if (!this.params) { callback(null); return; }\r\n        //console.log(\"Identify\");\r\n        this.params.geometry = event.mapPoint;\r\n        this.params.mapExtent = this.state.view.extent;\r\n        //document.getElementById(\"viewDiv\").style.cursor = \"wait\";\r\n        this.identifyTask.execute(this.params).then(function (response) {\r\n            //console.log(response);\r\n            callback(response);\r\n\r\n\r\n        });\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default ArcticMapLayer;","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport style from './ArcticMapLLDSearch.css';\r\n\r\nimport {\r\n    loadModules\r\n} from 'react-arcgis';\r\n\r\nclass ArcticMapLLDSearch extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            map: props.map,\r\n            view: props.view,\r\n            graphic: null\r\n        };\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n    }\r\n\r\n\r\n\r\n    componentWillMount() {\r\n        var self = this;\r\n        loadModules(['esri/Graphic',\r\n            \"esri/layers/FeatureLayer\",\r\n            \"esri/layers/MapImageLayer\",\r\n            \"esri/layers/ImageryLayer\",\r\n            \"esri/tasks/IdentifyTask\",\r\n            \"esri/tasks/support/IdentifyParameters\",\r\n            'esri/geometry/Geometry',\r\n            'esri/geometry/Polygon'\r\n        ]).then(([\r\n            Graphic,\r\n            FeatureLayer,\r\n            MapImageLayer,\r\n            ImageryLayer,\r\n            IdentifyTask,\r\n            IdentifyParameters,\r\n            Geometry,\r\n            Polygon\r\n        ]) => {\r\n\r\n\r\n            //var elestring = this.createElementFromHTML( `<input type=\"text\" placeholder=\"Find address or place\" aria-label=\"Search\" autocomplete=\"off\" tabindex=\"0\" class=\"esri-input esri-search__input\" aria-autocomplete=\"list\" aria-haspopup=\"true\" aria-owns=\"1687b00a338-widget-1-suggest-menu\" role=\"textbox\" data-node-ref=\"_inputNode\" title=\"Find address or place\">`);\r\n\r\n            self.top_right_node = document.createElement(\"div\");\r\n\r\n            self.Graphic = Graphic;\r\n            self.Geometry = Geometry;\r\n            self.Polygon = Polygon;\r\n\r\n            self.state.view.ui.add(self.top_right_node, {\r\n                position: \"top-right\",\r\n                index: 0\r\n            });\r\n\r\n\r\n            ReactDOM.render(\r\n                self.widgetRender(),\r\n                self.top_right_node\r\n            );\r\n\r\n\r\n\r\n\r\n        });\r\n    }\r\n\r\n    searchLLD(event) {\r\n        console.log(this.state.searchinput);\r\n        var self = this;\r\n\r\n        fetch(`https://gis.blm.gov/arcgis/rest/services/Cadastral/BLM_Natl_PLSS_CadNSDI/MapServer/exts/CadastralSpecialServices/FindLD?legaldescription=${this.state.searchinput}+&returnalllevels=&f=json`).then(r => r.json()).then(data => {\r\n            console.log(data);\r\n\r\n\r\n            var popupresults = data.features.map(function (feature) {\r\n\r\n                feature.geometry = self.Polygon.fromJSON(feature.geometry);\r\n\r\n                feature = new self.Graphic(feature);\r\n\r\n\r\n                var displayValue = feature.attributes.landdescription;\r\n\r\n\r\n                feature.popupTemplate = { // autocasts as new PopupTemplate()\r\n                    title: 'Legal Land Description',\r\n                    content: `<b>LLD</b>: ${displayValue}`,\r\n                    actions: [{ title: \"Select\", id: \"select-action\" }]\r\n                }\r\n\r\n\r\n\r\n                return feature\r\n            })\r\n\r\n            if (popupresults.length > 0) {\r\n                self.state.view.popup.open({\r\n                    features: popupresults,\r\n                    location: event.mapPoint\r\n                })\r\n\r\n          \r\n\r\n\r\n            }\r\n\r\n\r\n        })\r\n\r\n    }\r\n\r\n    handleChange(event) {\r\n        this.setState({ searchinput: event.target.value });\r\n    }\r\n\r\n    widgetRender() {\r\n        return <div className={style.lldsearchbar}>\r\n\r\n\r\n            <div style={{ display: 'inline-block', height: '32px', marginTop: '0px' }}  >\r\n\r\n\r\n                <input style={{ display: 'inline-block', height: '32px', verticalAlign: 'top' }} value={this.state.searchinput} onChange={this.handleChange} type=\"text\" placeholder=\"Find legal land description\" aria-label=\"Search\" className=\"esri-input\" title=\"Find leagal land desription\" />\r\n\r\n                <div style={{ display: 'inline-block', width: '32px', height: '32px', verticalAlign: 'top' }} role=\"button\" title=\"Search\" className=\"esri-search__submit-button esri-widget--button\" onClick={this.searchLLD.bind(this)}>\r\n                    <span style={{ display: 'block', paddingTop: '8px' }} aria-hidden=\"true\" role=\"presentation\" className=\"esri-icon-search\"></span>\r\n\r\n                </div>\r\n            </div>\r\n\r\n\r\n\r\n        </div>;\r\n    }\r\n\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n\r\n\r\n\r\n\r\n}\r\n\r\nexport default ArcticMapLLDSearch;"],"names":["ArcticMap","props","state","lat","lng","handleMapLoad","bind","handleMapClick","layers","self","index","children","React","Children","map","child","type","name","cloneElement","c","push","sort","l","reverse","basemap","hideBasemapButton","handleShowBasemaps","loading","event","view","ui","add","basemapGallery","setState","htmlString","div","document","createElement","innerHTML","trim","firstChild","json","editor","setEditFeature","then","LayerList","Locate","BasemapGallery","Home","Zoom","Search","Locator","geometryEngine","layerList","item","panel","popup","dockEnabled","dockOptions","position","watch","graphic","graphicTemplate","getEffectivePopupTemplate","actions","items","visible","undefined","viewModel","on","action","id","target","selectedFeature","editing","identresults","getElementsByClassName","style","cursor","eachSeries","layer","cb","identify","results","err","forEach","ir","acres","geodesicArea","res","feature","geometry","reduce","a","b","concat","log","r1","r2","popupresults","result","layerName","attributes","displayValue","displayFieldName","popupTemplate","renderPopup","title","length","close","open","mapPoint","e","locateBtn","homeBtn","remove","zoom","search","searchWidget","evt","Event","bubbles","defineProperty","value","enumerable","onmapready","Component","ArcticMapEdit","graphics","Graphic","GraphicsLayer","SketchViewModel","Geometry","tempGraphicsLayer","listMode","sketchViewModel","setUpClickHandler","symbol","single","hideEditors","geojson","arcgisToGeoJSON","toJSON","datajson","firenewfeature","editGraphic","top_right_node","loaded","nofire","reset","removeAll","fromJSON","polygonSymbol","goTo","setGeoJson","data","onnewfeature","create","mode","point","padding","addPointClick","line","addLineClick","polygon","addPolyClick","square","addRecClick","circle","addCircleClick","render","widgetRender","hitTest","response","update","selectedButton","ArcticMapLayer","FeatureLayer","MapImageLayer","ImageryLayer","GeoJSONLayer","IdentifyTask","IdentifyParameters","Point","SimpleMarkerSymbol","Extent","featureLayer","src","layerRef","maplayer","when","layerids","allSublayers","sublayer","identifyTask","params","tolerance","layerIds","layerOption","width","height","returnGeometry","imagelayer","geojsonLayer","dataarr","babelHelpers.typeof","features","esrijson","geojsonToArcGIS","obj","template","coordinates","markerSymbol","pointGraphic","properties","onready","popupText","atts","Object","getOwnPropertyNames","att","callback","mapExtent","extent","execute","ArcticMapLLDSearch","handleChange","Polygon","searchinput","r","landdescription","lldsearchbar","display","marginTop","verticalAlign","searchLLD","paddingTop"],"mappings":"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"}